{"ast":null,"code":"import _asyncToGenerator from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useContext}from'react';import{useNavigate}from'react-router-dom';import*as userService from'../../api/user.service';import{UserContext}from'../../UserContext';import RemoveArtist from'../../components/RemoveArtist';import GetTourDates from'../../components/GetTourDates';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Profile(){var _useContext=useContext(UserContext),user=_useContext.user,setUser=_useContext.setUser;var _useState=useState({artists:[],img:\"\",name:\"\"}),_useState2=_slicedToArray(_useState,2),userProfile=_useState2[0],setUserProfile=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),edit=_useState4[0],setEdit=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],setImage=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),name=_useState8[0],setName=_useState8[1];var navigate=useNavigate();var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var id;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:id=user.userId;_context.next=3;return userService.getUserInfo(id).then(function(res){setUserProfile(res.data.user);});case 3:case\"end\":return _context.stop();}}},_callee);}));return function getUser(){return _ref.apply(this,arguments);};}();var editProfile=function editProfile(){setEdit(true);};var updateProfile=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var id,body;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();id=user.userId;body={name:name,img:image};_context2.next=5;return userService.editProfile(id,body).then(function(res){setUserProfile(res.data.updatedUser);setEdit(false);});case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function updateProfile(_x){return _ref2.apply(this,arguments);};}();var destroy=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var id;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();id=user.userId;_context3.next=4;return userService.destroyProfile(id).then(function(res){setUser(undefined);navigate('/');});case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function destroy(_x2){return _ref3.apply(this,arguments);};}();var removeArtist=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(id,artistId,idx){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return userService.removeArtist(id,artistId).then(function(res){getUser();}).catch(function(err){console.log(err);});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function removeArtist(_x3,_x4,_x5){return _ref4.apply(this,arguments);};}();var getTourDates=function getTourDates(keyWords){navigate('/touring_info',{state:{keyWords:keyWords}});};useEffect(function(){getUser();},[]);if(!edit){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{id:\"profile\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"profile-img\",children:/*#__PURE__*/_jsx(\"img\",{id:\"profile-img\",src:userProfile.img})}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Welcome, \",userProfile.name]}),/*#__PURE__*/_jsxs(\"div\",{id:\"artists-to-see-live\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Artists I want to see live:\"}),/*#__PURE__*/_jsx(\"ul\",{children:userProfile.artists.length<1?/*#__PURE__*/_jsx(\"p\",{children:\"You haven't add any artists.\"}):userProfile.artists.map(function(artist,idx){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsxs(\"pre\",{children:[artist.artist,/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(RemoveArtist,{artistId:artist._id,id:user.userId,idx:idx,removeArtist:removeArtist})})]}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(GetTourDates,{keyWords:artist.artist,getTourDates:getTourDates})})]},artist._id);})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:editProfile,id:\"edit-profile\",children:\"edit profile\"})]})});}else{return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{id:\"edit-profile\",children:[/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsx(\"span\",{children:\"Image\"})}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setImage(e.target.value);},value:image,placeholder:userProfile.img}),/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsx(\"span\",{children:\"Name\"})}),/*#__PURE__*/_jsx(\"input\",{onChange:function onChange(e){return setName(e.target.value);},value:name,placeholder:userProfile.name})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"edit-profile-btns-div\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:destroy,children:\"Delete Account\"}),/*#__PURE__*/_jsx(\"button\",{onClick:updateProfile,children:\"Submit\"})]})]})});}}","map":{"version":3,"names":["React","useState","useEffect","useContext","useNavigate","userService","UserContext","RemoveArtist","GetTourDates","Profile","user","setUser","artists","img","name","userProfile","setUserProfile","edit","setEdit","image","setImage","setName","navigate","getUser","id","userId","getUserInfo","then","res","data","editProfile","updateProfile","e","preventDefault","body","updatedUser","destroy","destroyProfile","undefined","removeArtist","artistId","idx","catch","err","console","log","getTourDates","keyWords","state","length","map","artist","_id","target","value"],"sources":["/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/src/pages/Profile/index.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport * as userService from '../../api/user.service';\nimport { UserContext } from '../../UserContext';\nimport RemoveArtist from '../../components/RemoveArtist';\nimport GetTourDates from '../../components/GetTourDates';\n\nexport default function Profile() {\n    const { user, setUser } = useContext(UserContext);\n    const [ userProfile, setUserProfile ] = useState({\n        artists: [], \n        img: \"\", \n        name: \"\",\n    });\n    const [ edit, setEdit ] = useState(false);\n    const [ image, setImage ] = useState(); \n    const [ name, setName ] = useState();\n    const navigate = useNavigate();\n\n    const getUser = async() => {\n        const id = user.userId;\n        await userService.getUserInfo(id).then((res) => {\n            setUserProfile(res.data.user);\n        })\n    }\n\n    const editProfile = () => {\n        setEdit(true);\n    }\n\n    const updateProfile = async(e) => {\n        e.preventDefault();\n        const id = user.userId;\n        const body = {\n            name: name,\n            img: image\n        }\n        await userService.editProfile(id, body).then((res) => {\n            setUserProfile(res.data.updatedUser)\n            setEdit(false);\n        })\n    }\n\n    const destroy = async(e) => {\n        e.preventDefault();\n        const id = user.userId;\n        await userService.destroyProfile(id).then((res) => {\n            setUser(undefined);\n            navigate('/')\n        })\n    }\n\n    const removeArtist = async(id, artistId, idx) => {\n        await userService.removeArtist(id, artistId).then((res) => {\n            getUser();\n        }).catch((err) => {\n            console.log(err);\n        });\n    }\n\n    const getTourDates = (keyWords) => {\n        navigate('/touring_info', {state: {keyWords}});\n    }\n\n    useEffect(() => {\n        getUser()\n    }, []);\n\n    if(!edit){\n        return (\n            <>\n                <div id=\"profile\">\n                    <div class=\"profile-img\"> \n                        <img id=\"profile-img\" src={userProfile.img} />\n                    </div> \n                    <h3>Welcome, {userProfile.name}</h3>\n                    <div id=\"artists-to-see-live\">\n                        <p>Artists I want to see live:</p>\n                            <ul>\n                                { userProfile.artists.length < 1 ? (<p>You haven't add any artists.</p>): userProfile.artists.map((artist, idx) => {\n                                    return (\n                                <li key={artist._id}>\n                                    <pre>\n                                    {artist.artist} \n                                    <span>\n                                        <RemoveArtist artistId={artist._id} id={user.userId} idx={idx} removeArtist={removeArtist}/>\n                                    </span> \n                                    </pre>\n                                    <span>\n                                        <GetTourDates keyWords={artist.artist} getTourDates={getTourDates} />\n                                    </span>\n                                </li>)\n                                }) }\n                            </ul>\n                        </div>\n                    <button onClick={editProfile} id=\"edit-profile\">\n                        edit profile\n                    </button>\n                </div>\n            </> \n        )\n    } else {\n        return (\n            <>\n                <div id=\"edit-profile\">\n                    <form>\n                        <label>\n                            <span>Image</span>\n                        </label>\n                        <input onChange={e => setImage(e.target.value)} value={image} placeholder={userProfile.img}/>\n                        \n                        <label>\n                            <span>Name</span>\n                        </label>\n                        <input onChange={e => setName(e.target.value)} value={name} placeholder={userProfile.name}/>\n                    </form>\n                    <div id='edit-profile-btns-div'>\n                    <button \n                            onClick={destroy}\n                        >\n                            Delete Account\n                        </button>\n                        <button onClick={updateProfile}>\n                            Submit\n                        </button>\n                    </div>\n                </div>\n            </> \n        )\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}
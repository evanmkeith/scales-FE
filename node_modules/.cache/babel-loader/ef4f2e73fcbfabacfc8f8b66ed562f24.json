{"ast":null,"code":"import _asyncToGenerator from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/regenerator/index.js\";import Player from'../../components/Player';import{useLocation}from'react-router-dom';import{useEffect,useState,useContext}from'react';import*as spotifyAuthService from'../../api/spotify.auth';import{UserContext}from'../../UserContext';import AlbumTrack from'../../components/AlbumTrack';import AddArtist from'../../components/AddArtist';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Listen(){var location=useLocation();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tracks=_useState2[0],setTracks=_useState2[1];var _useContext=useContext(UserContext),user=_useContext.user,setUser=_useContext.setUser;var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),trackToPlay=_useState4[0],setTrackToPlay=_useState4[1];var album=location.state.album;var playTrack=function playTrack(track){setTrackToPlay(track);};var addTrack=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(track){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return spotifyAuthService.addTrack(track,user).then(function(res){console.log(res);}).catch(function(error){console.log(error);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function addTrack(_x){return _ref.apply(this,arguments);};}();var getTracks=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return spotifyAuthService.getTracks(album.id,user.accessToken).then(function(res){setTracks(res.data.albumTracks);}).catch(function(err){console.log(err);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function getTracks(){return _ref2.apply(this,arguments);};}();console.log('TRACKS',tracks);useEffect(function(){getTracks();},[]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{id:\"listen-div\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"listen-album\",children:[/*#__PURE__*/_jsx(\"img\",{src:album.img.url}),/*#__PURE__*/_jsx(\"p\",{children:album.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"by: \",album.artist[0].name]}),/*#__PURE__*/_jsx(AddArtist,{id:user.userId,artist:album.artist[0].name})]}),/*#__PURE__*/_jsx(\"div\",{id:\"listen-tracks\",children:tracks.map(function(track){return/*#__PURE__*/_jsx(AlbumTrack,{track:track,addTrack:addTrack,playTrack:playTrack},track.uri);})}),/*#__PURE__*/_jsx(\"div\",{id:\"listen-player\",children:/*#__PURE__*/_jsx(Player,{accessToken:user.accessToken,trackUri:trackToPlay===null||trackToPlay===void 0?void 0:trackToPlay.uri})})]})});}","map":{"version":3,"names":["Player","useLocation","useEffect","useState","useContext","spotifyAuthService","UserContext","AlbumTrack","AddArtist","Listen","location","tracks","setTracks","user","setUser","trackToPlay","setTrackToPlay","album","state","playTrack","track","addTrack","then","res","console","log","catch","error","getTracks","id","accessToken","data","albumTracks","err","img","url","name","artist","userId","map","uri"],"sources":["/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/src/pages/Listen/index.js"],"sourcesContent":["import Player from '../../components/Player';\nimport { useLocation } from 'react-router-dom';\nimport { useEffect, useState, useContext } from 'react';\nimport * as spotifyAuthService from '../../api/spotify.auth';\nimport { UserContext } from '../../UserContext';\nimport AlbumTrack from '../../components/AlbumTrack';\nimport AddArtist from '../../components/AddArtist';\n\nexport default function Listen() {\n    const location = useLocation();\n    const [ tracks, setTracks ] = useState([]);\n    const { user, setUser } = useContext(UserContext);\n    const [ trackToPlay, setTrackToPlay ] = useState();\n    const album = location.state.album;\n\n    const playTrack = (track) => {\n        setTrackToPlay(track);\n    };\n\n    const addTrack = async(track) => {\n        await spotifyAuthService.addTrack(track, user).then(\n            (res) => {\n                console.log(res)\n            }\n        ).catch((error) => {\n            console.log(error);\n        })\n    }\n\n    const getTracks = async() => {\n        await spotifyAuthService.getTracks(album.id, user.accessToken).then((res) => {\n            setTracks( res.data.albumTracks);\n        }).catch((err) => {\n            console.log(err);\n        });\n    }\n\n    console.log('TRACKS', tracks);\n\n    useEffect(() => {\n        getTracks();\n    }, []);\n\n    return (\n        <>\n            <div id='listen-div'>\n                <div id='listen-album'> \n                    <img src={album.img.url} /> \n                    <p>{album.name}</p>\n                    <p>by: {album.artist[0].name}</p>\n                    <AddArtist id={user.userId} artist={album.artist[0].name}/>\n                </div>\n                <div id='listen-tracks'>\n                        {tracks.map((track) => {\n                            return (\n                                <AlbumTrack \n                                    key={track.uri} \n                                    track={track} \n                                    addTrack={addTrack} \n                                    playTrack={playTrack}\n                                /> \n                            )\n                        })}\n                </div>\n                <div id='listen-player'>\n                    <Player accessToken={user.accessToken} trackUri={trackToPlay?.uri}/>\n                </div>\n            </div>\n        </>\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _asyncToGenerator from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/regenerator/index.js\";import React,{useContext,useEffect,useState}from'react';import*as spotifyAuthService from'../../api/spotify.auth';import{UserContext}from'../../UserContext';import Player from'../../components/Player';import PlaylistTrack from'../../components/PlaylistTrack';import AddArtist from'../../components/AddArtist';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Playlist(){var _useContext=useContext(UserContext),user=_useContext.user,setUser=_useContext.setUser;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),tracks=_useState2[0],setTracks=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),trackToPlay=_useState4[0],setTrackToPlay=_useState4[1];var playTrack=function playTrack(track){setTrackToPlay(track);};var removeTrack=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(track){var removed;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:removed=tracks.splice(tracks.indexOf(track),1);_context.next=3;return spotifyAuthService.removeTrack(track,user).then(function(res){console.log(res);getPlaylist();}).catch(function(error){console.log(error);});case 3:case\"end\":return _context.stop();}}},_callee);}));return function removeTrack(_x){return _ref.apply(this,arguments);};}();var createSpotifyPlaylist=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return spotifyAuthService.createSpotifyPlaylist(user).then(function(res){console.log(res);}).catch(function(error){console.log(error);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function createSpotifyPlaylist(){return _ref2.apply(this,arguments);};}();var getPlaylist=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return spotifyAuthService.getPlaylist(user).then(function(res){var tracks=res.data.newTracks;console.log(\"tracks: \",tracks);setTracks(tracks);return tracks;}).catch(function(error){console.log(error);});case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function getPlaylist(){return _ref3.apply(this,arguments);};}();useEffect(function(){if(!user.playlistId){createSpotifyPlaylist();getPlaylist();}else{getPlaylist();}},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Scales App Playlist\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"playlist\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"tracks\",children:tracks.map(function(track){return/*#__PURE__*/_jsxs(\"div\",{class:\"track\",children:[/*#__PURE__*/_jsx(PlaylistTrack,{track:track,playTrack:playTrack,removeTrack:removeTrack},track.uri),/*#__PURE__*/_jsx(AddArtist,{artist:track.artist,id:user.userId})]});})}),/*#__PURE__*/_jsx(\"div\",{id:\"player\",children:/*#__PURE__*/_jsx(Player,{accessToken:user.accessToken,trackUri:trackToPlay===null||trackToPlay===void 0?void 0:trackToPlay.uri})})]})]});};","map":{"version":3,"names":["React","useContext","useEffect","useState","spotifyAuthService","UserContext","Player","PlaylistTrack","AddArtist","Playlist","user","setUser","tracks","setTracks","trackToPlay","setTrackToPlay","playTrack","track","removeTrack","removed","splice","indexOf","then","res","console","log","getPlaylist","catch","error","createSpotifyPlaylist","data","newTracks","playlistId","map","uri","artist","userId","accessToken"],"sources":["/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/src/pages/Playlist/index.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport * as spotifyAuthService from '../../api/spotify.auth';\nimport { UserContext } from '../../UserContext';\nimport Player from '../../components/Player';\nimport PlaylistTrack from '../../components/PlaylistTrack';\nimport AddArtist from '../../components/AddArtist';\n\nexport default function Playlist() {\n    const { user, setUser } = useContext(UserContext);\n    const [ tracks, setTracks ] = useState([]);\n    const [ trackToPlay, setTrackToPlay ] = useState()\n\n    const playTrack = (track) => {\n        setTrackToPlay(track);\n    };\n\n    const removeTrack = async(track) => {\n        let removed = tracks.splice(tracks.indexOf(track), 1);\n\n        await spotifyAuthService.removeTrack(track, user).then(\n            (res) => {\n                console.log(res)\n                getPlaylist();\n            }\n        ).catch((error) => {\n            console.log(error);\n        })\n    }\n\n    const createSpotifyPlaylist = async() => {\n        await spotifyAuthService.createSpotifyPlaylist(user).then(\n            (res) => {\n                console.log(res);\n            }\n        ).catch((error) => {\n            console.log(error);\n        })\n    };\n\n    const getPlaylist = async() => {\n        await spotifyAuthService.getPlaylist(user).then(\n            (res) => {\n                const tracks = res.data.newTracks;\n                console.log(\"tracks: \", tracks);\n                setTracks(tracks);\n                return tracks\n            }\n        ).catch((error) => {\n            console.log(error);\n        })\n    };\n\n    useEffect(() => {\n        if(!user.playlistId){\n            createSpotifyPlaylist();\n            getPlaylist();\n        } else {\n            getPlaylist();\n        }\n    }, []);\n\n    return (\n        <> \n            <h3>Scales App Playlist</h3>\n            <div id=\"playlist\">\n                <div id='tracks'>\n                {tracks.map((track) => {\n                    return (\n                        <div class='track'>\n                            <PlaylistTrack \n                                track={track}\n                                key={track.uri}\n                                playTrack={playTrack}\n                                removeTrack={removeTrack}\n                            />\n                            <AddArtist artist={track.artist} id={user.userId}/>\n                        </div>\n                    )\n                })}\n                </div>\n                <div id='player'>\n                    <Player accessToken={user.accessToken} trackUri={trackToPlay?.uri}/> \n                </div>\n            </div>\n        </>\n    );\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}
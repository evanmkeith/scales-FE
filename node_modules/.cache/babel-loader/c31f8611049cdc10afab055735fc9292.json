{"ast":null,"code":"import _asyncToGenerator from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/node_modules/@babel/runtime/regenerator/index.js\";import*as spotifyAuthService from'../../api/spotify.auth';import React,{useEffect}from'react';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";export default function Login(props){var navigate=useNavigate();var requestAuth=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return spotifyAuthService.requestAuth().then(function(res){console.log('response: ',res);window.location.href=res.data.authUrl;});case 2:case\"end\":return _context.stop();}}},_callee);}));return function requestAuth(){return _ref.apply(this,arguments);};}();var getToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(authCode){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"getting token\");_context2.next=3;return spotifyAuthService.getToken(authCode).then(function(res){console.log(\"user id\",res.data);props.setUser(res.data.token);localStorage.setItem(\"scalesLoggedInBefore\",true);localStorage.setItem(\"autoLog\",false);if(window.location.href!=='http://localhost:3000/profile'){navigate('/profile');}});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function getToken(_x){return _ref2.apply(this,arguments);};}();useEffect(function(){if(localStorage.getItem(\"autoLog\")==='false'){localStorage.setItem(\"autoLog\",true);requestAuth();}if(window.location.href.includes('code')){var authCode=new URLSearchParams(window.location.search).get('code');getToken(authCode);};},[]);return/*#__PURE__*/_jsx(\"div\",{id:\"login\",children:/*#__PURE__*/_jsx(\"button\",{onClick:requestAuth,children:\"Login with Spotify\"})});}","map":{"version":3,"names":["spotifyAuthService","React","useEffect","useNavigate","Login","props","navigate","requestAuth","then","res","console","log","window","location","href","data","authUrl","getToken","authCode","setUser","token","localStorage","setItem","getItem","includes","URLSearchParams","search","get"],"sources":["/Users/evankeith/Documents/FX119/unit-four/deliverables/capstone/scales-FE/scales-fe/src/components/Login/index.js"],"sourcesContent":["import * as spotifyAuthService from '../../api/spotify.auth';\nimport React, { useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\n\nexport default function Login(props) {\n    const navigate = useNavigate();\n\n\n    const requestAuth = async() => {\n        await spotifyAuthService.requestAuth().then((res) => {\n            console.log('response: ',res);\n            window.location.href = res.data.authUrl;\n        })\n    }\n    \n    const getToken = async(authCode) => {\n        console.log(\"getting token\")\n        await spotifyAuthService.getToken(authCode).then((res) => {\n            console.log(\"user id\", res.data);\n            props.setUser(res.data.token);\n            localStorage.setItem(\"scalesLoggedInBefore\", true);\n            localStorage.setItem(\"autoLog\", false);\n            if(window.location.href !== 'http://localhost:3000/profile'){\n                navigate('/profile');\n            }\n        })\n    }\n    \n    useEffect(() => {\n        if(localStorage.getItem(\"autoLog\") === 'false') {\n            localStorage.setItem(\"autoLog\", true);\n            requestAuth()\n        }\n        if(window.location.href.includes('code')){\n            const authCode = new URLSearchParams(window.location.search).get('code');\n            getToken(authCode);\n        };\n    }, []);\n    \n    return (\n        <div id='login'>\n            <button onClick={requestAuth}>Login with Spotify</button>\n        </div>\n    );\n\n}\n"],"mappings":"uVAAA,MAAO,GAAKA,CAAAA,kBAAZ,KAAoC,wBAApC,CACA,MAAOC,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,WAAT,KAA4B,kBAA5B,C,2CAGA,cAAe,SAASC,CAAAA,KAAT,CAAeC,KAAf,CAAsB,CACjC,GAAMC,CAAAA,QAAQ,CAAGH,WAAW,EAA5B,CAGA,GAAMI,CAAAA,WAAW,0FAAG,yJACVP,CAAAA,kBAAkB,CAACO,WAAnB,GAAiCC,IAAjC,CAAsC,SAACC,GAAD,CAAS,CACjDC,OAAO,CAACC,GAAR,CAAY,YAAZ,CAAyBF,GAAzB,EACAG,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuBL,GAAG,CAACM,IAAJ,CAASC,OAAhC,CACH,CAHK,CADU,uDAAH,kBAAXT,CAAAA,WAAW,0CAAjB,CAOA,GAAMU,CAAAA,QAAQ,2FAAG,kBAAMC,QAAN,sHACbR,OAAO,CAACC,GAAR,CAAY,eAAZ,EADa,uBAEPX,CAAAA,kBAAkB,CAACiB,QAAnB,CAA4BC,QAA5B,EAAsCV,IAAtC,CAA2C,SAACC,GAAD,CAAS,CACtDC,OAAO,CAACC,GAAR,CAAY,SAAZ,CAAuBF,GAAG,CAACM,IAA3B,EACAV,KAAK,CAACc,OAAN,CAAcV,GAAG,CAACM,IAAJ,CAASK,KAAvB,EACAC,YAAY,CAACC,OAAb,CAAqB,sBAArB,CAA6C,IAA7C,EACAD,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAgC,KAAhC,EACA,GAAGV,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAyB,+BAA5B,CAA4D,CACxDR,QAAQ,CAAC,UAAD,CAAR,CACH,CACJ,CARK,CAFO,yDAAH,kBAARW,CAAAA,QAAQ,6CAAd,CAaAf,SAAS,CAAC,UAAM,CACZ,GAAGmB,YAAY,CAACE,OAAb,CAAqB,SAArB,IAAoC,OAAvC,CAAgD,CAC5CF,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAgC,IAAhC,EACAf,WAAW,GACd,CACD,GAAGK,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBU,QAArB,CAA8B,MAA9B,CAAH,CAAyC,CACrC,GAAMN,CAAAA,QAAQ,CAAG,GAAIO,CAAAA,eAAJ,CAAoBb,MAAM,CAACC,QAAP,CAAgBa,MAApC,EAA4CC,GAA5C,CAAgD,MAAhD,CAAjB,CACAV,QAAQ,CAACC,QAAD,CAAR,CACH,EACJ,CATQ,CASN,EATM,CAAT,CAWA,mBACI,YAAK,EAAE,CAAC,OAAR,uBACI,eAAQ,OAAO,CAAEX,WAAjB,gCADJ,EADJ,CAMH"},"metadata":{},"sourceType":"module"}